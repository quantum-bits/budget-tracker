{% extends "base.html" %}

{% block content %}
<form action=""  method="post">
  {% csrf_token %}


<div class="content-center">
<div>
<select name="checked" id="option1">
   <option value="checked_only">Checked Only</option>
   <option value="all" {% if not user_preferences.view_checked_only %} selected {% endif %}>Checked & Other</option>
 </select>
</div>
<div>
<select name="encumbered" id="option2">
   <option value="encumbered_only">Encumbered Only</option>
   <option value="all" {% if not user_preferences.view_encumbrances_only %} selected {% endif %}>Encumbered & Other</option>
 </select>
</div>
<div>
<select name="future" id="option3">
   <option value="future_only">Future Only</option>
   <option value="all" {% if not user_preferences.view_future_only %} selected {% endif %}>Future & Other</option>
 </select>
</div>
<div>
<p><input type="submit" alt="register" /></p>
</div>

<a href="{% url 'new_budget_entry' %}?next={{ request.path|urlencode }}"> New Budget Entry </a>
<p></p>

    <table class="table table-striped table-bordered table-hover">
      <thead>
	<tr>
	  <th colspan="5"> Budget Entries </th>
	</tr>
	<tr>
	<td> Date </td>
	<td> Description </td>
	<td style="text-align: center;"> Budget Line </td>
	<td style="text-align: center;"> Debit </td>
	<td style="text-align: center;"> Credit </td>
	<td style="text-align: center;"> Checked </td>
	<td style="text-align: center;"> Encumbrance </td>
	<td style="text-align: center;"> Future </td>
	<td style="text-align: center;"> Edit/Delete </td>
	</thead>

      <tbody>
	    {% for expense in expense_list %}
	    <tr>
	      <td> {{expense.date}} </td>
	      <td> {{expense.description}}</td>
	      <td> 
		{% if expense.expense_budget_line.all.count > 1 %}
		{% for ebl in expense.expense_budget_line.all %}
		<div>
	         {{ ebl.budget_line.code }}{% if ebl.subaccount != None %} ({{ ebl.subaccount }}){% endif %}: 
		   {% if ebl.debit_or_credit == ebl.DEBIT %} ({{ebl.amount }}) {% else %} {{ebl.amount}} {% endif %} 
		</div>
		{% endfor %}
		{% else %}
		{% for ebl in expense.expense_budget_line.all %}
		{{ ebl.budget_line.code }}{% if ebl.subaccount != None %} ({{ ebl.subaccount }}){% endif %}
		{% endfor %}
		{% endif %}
	      </td>
	      {% if expense.total_debit > 0 %} 
	        <td> {{expense.total_debit}} </td>
	      {% else %} <td></td>
	      {% endif %}
	      {% if expense.total_credit > 0 %} 
	        <td> {{expense.total_credit}} </td>
	      {% else %} <td></td>
	      {% endif %}
	      <td style="text-align: center;"> {% if expense.checked %} x 
		{% else %}
		<input type="checkbox" name="expense_check_flag" id="option{{expense.id}}" value={{expense.id}} />
		{% endif %} </td>
	      <td style="text-align: center;"> {% if expense.encumbered %} x {% endif %} </td>
	      <td style="text-align: center;"> {% if expense.future_expense %} x {% endif %} </td>
	      <td style="text-align: center;"> 
		<a href="{% url 'new_budget_entry' expense.id %}?next={{ request.path|urlencode }}" >Edit</a>  | 
		<a href="{% url 'delete_expense_confirmation' expense.id %}">Delete</a> </td>
	    </tr>
	    {% endfor %}
      </tbody>
    </table>
 </div>

</form>

<!--
<script>
  $(function() {

  $('#btn1').on('mouseover', function(){
    $('#panel1').fadeToggle(1000);
  });

  });

</script>
-->

  <script>
    $(window).load(function(){
    $("#nav-entries").addClass("current");
    $('.page-name').find('h1').replaceWith('<h1>Budget Entries</h1>');
    $(".page-name").stop().animate({opacity: 1,'margin-left': '5%'}, 700);});
  </script>

{% endblock %}
